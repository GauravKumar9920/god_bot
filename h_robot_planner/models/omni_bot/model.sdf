<?xml version="1.0" ?>
<sdf version="1.10">
  <model name="omni_bot">
    <pose>0 0 0.07 0 0 0</pose>
    <static>false</static>
    <self_collide>false</self_collide>

    <!-- ================= Base ================= -->
    <link name="base_link">
      <pose>0 0 0.07 0 0 0</pose>
      <inertial>
        <mass>4.0</mass>
        <inertia>
          <!-- Modestly larger inertia to improve stability -->
          <ixx>0.05</ixx><ixy>0.0</ixy><ixz>0.0</ixz>
          <iyy>0.07</iyy><iyz>0.0</iyz>
          <izz>0.09</izz>
        </inertia>
      </inertial>
      <collision name="base_collision">
        <geometry><box><size>0.30 0.25 0.10</size></box></geometry>
        <surface>
          <contact><collide_without_contact>false</collide_without_contact></contact>
          <friction>
            <ode><mu>1.0</mu><mu2>1.0</mu2></ode>
          </friction>
        </surface>
      </collision>
      <visual name="base_visual">
        <geometry><box><size>0.30 0.25 0.10</size></box></geometry>
        <material>
          <ambient>0.2 0.2 0.8 1</ambient>
          <diffuse>0.2 0.2 0.8 1</diffuse>
          <specular>0.2 0.2 0.8 1</specular>
        </material>
      </visual>
    </link>

    <!-- ===== Wheels (cyl axis Z). Roll +90deg so cylinder Z aligns with model Y (axle). ===== -->
    <!-- Parameters: wheelbase=0.38 (x), separation=0.30 (y), radius=0.05, thickness=0.03 -->

    <!-- Common wheel collision/visual block -->
    <!-- Front-left -->
    <link name="wheel_fl">
      <pose>0.19 0.15 0.05 1.57079632679 0 0</pose>
      <inertial>
        <mass>0.6</mass>
        <inertia>
          <ixx>0.001</ixx><ixy>0</ixy><ixz>0</ixz>
          <iyy>0.0006</iyy><iyz>0</iyz>
          <izz>0.001</izz>
        </inertia>
      </inertial>
      <collision name="col">
        <geometry><cylinder><radius>0.05</radius><length>0.03</length></cylinder></geometry>
        <surface>
          <friction>
            <ode><mu>1.2</mu><mu2>1.0</mu2></ode>
          </friction>
        </surface>
      </collision>
      <visual name="vis">
        <geometry><cylinder><radius>0.05</radius><length>0.03</length></cylinder></geometry>
        <material><ambient>0.1 0.1 0.1 1</ambient></material>
      </visual>
    </link>
    <joint name="front_left_wheel_joint" type="revolute">
      <parent>base_link</parent>
      <child>wheel_fl</child>
      <axis>
        <!-- rotate about +Y of the model frame -->
        <xyz>0 1 0</xyz>
        <xyz_expressed_in>__model__</xyz_expressed_in>
        <limit><lower>-1e16</lower><upper>1e16</upper><effort>50</effort><velocity>100</velocity></limit>
        <dynamics><damping>0.2</damping><friction>0.0</friction></dynamics>
      </axis>
    </joint>

    <!-- Front-right -->
    <link name="wheel_fr">
      <pose>0.19 -0.15 0.05 1.57079632679 0 0</pose>
      <inertial>
        <mass>0.6</mass>
        <inertia>
          <ixx>0.001</ixx><ixy>0</ixy><ixz>0</ixz>
          <iyy>0.0006</iyy><iyz>0</iyz>
          <izz>0.001</izz>
        </inertia>
      </inertial>
      <collision name="col">
        <geometry><cylinder><radius>0.05</radius><length>0.03</length></cylinder></geometry>
        <surface>
          <friction>
            <ode><mu>1.2</mu><mu2>1.0</mu2></ode>
          </friction>
        </surface>
      </collision>
      <visual name="vis"><geometry><cylinder><radius>0.05</radius><length>0.03</length></cylinder></geometry></visual>
    </link>
    <joint name="front_right_wheel_joint" type="revolute">
      <parent>base_link</parent>
      <child>wheel_fr</child>
      <axis>
        <xyz>0 1 0</xyz>
        <xyz_expressed_in>__model__</xyz_expressed_in>
        <limit><lower>-1e16</lower><upper>1e16</upper><effort>50</effort><velocity>100</velocity></limit>
        <dynamics><damping>0.2</damping><friction>0.0</friction></dynamics>
      </axis>
    </joint>

    <!-- Back-left -->
    <link name="wheel_bl">
      <pose>-0.19 0.15 0.05 1.57079632679 0 0</pose>
      <inertial>
        <mass>0.6</mass>
        <inertia>
          <ixx>0.001</ixx><ixy>0</ixy><ixz>0</ixz>
          <iyy>0.0006</iyy><iyz>0</iyz>
          <izz>0.001</izz>
        </inertia>
      </inertial>
      <collision name="col">
        <geometry><cylinder><radius>0.05</radius><length>0.03</length></cylinder></geometry>
        <surface>
          <friction>
            <ode><mu>1.2</mu><mu2>1.0</mu2></ode>
          </friction>
        </surface>
      </collision>
      <visual name="vis"><geometry><cylinder><radius>0.05</radius><length>0.03</length></cylinder></geometry></visual>
    </link>
    <joint name="back_left_wheel_joint" type="revolute">
      <parent>base_link</parent>
      <child>wheel_bl</child>
      <axis>
        <xyz>0 1 0</xyz>
        <xyz_expressed_in>__model__</xyz_expressed_in>
        <limit><lower>-1e16</lower><upper>1e16</upper><effort>50</effort><velocity>100</velocity></limit>
        <dynamics><damping>0.2</damping><friction>0.0</friction></dynamics>
      </axis>
    </joint>

    <!-- Back-right -->
    <link name="wheel_br">
      <pose>-0.19 -0.15 0.05 1.57079632679 0 0</pose>
      <inertial>
        <mass>0.6</mass>
        <inertia>
          <ixx>0.001</ixx><ixy>0</ixy><ixz>0</ixz>
          <iyy>0.0006</iyy><iyz>0</iyz>
          <izz>0.001</izz>
        </inertia>
      </inertial>
      <collision name="col">
        <geometry><cylinder><radius>0.05</radius><length>0.03</length></cylinder></geometry>
        <surface>
          <friction>
            <ode><mu>1.2</mu><mu2>1.0</mu2></ode>
          </friction>
        </surface>
      </collision>
      <visual name="vis"><geometry><cylinder><radius>0.05</radius><length>0.03</length></cylinder></geometry></visual>
    </link>
    <joint name="back_right_wheel_joint" type="revolute">
      <parent>base_link</parent>
      <child>wheel_br</child>
      <axis>
        <xyz>0 1 0</xyz>
        <xyz_expressed_in>__model__</xyz_expressed_in>
        <limit><lower>-1e16</lower><upper>1e16</upper><effort>50</effort><velocity>100</velocity></limit>
        <dynamics><damping>0.2</damping><friction>0.0</friction></dynamics>
      </axis>
    </joint>

    <!-- ================= Plugins ================= -->
    <plugin filename="gz-sim-mecanum-drive-system" name="gz::sim::systems::MecanumDrive">
      <front_left_joint>front_left_wheel_joint</front_left_joint>
      <front_right_joint>front_right_wheel_joint</front_right_joint>
      <back_left_joint>back_left_wheel_joint</back_left_joint>
      <back_right_joint>back_right_wheel_joint</back_right_joint>
      <wheelbase>0.38</wheelbase>
      <wheel_separation>0.30</wheel_separation>
      <wheel_radius>0.05</wheel_radius>
      <odom_publish_frequency>50</odom_publish_frequency>
      <topic>/model/omni_bot/cmd_vel</topic>
    </plugin>

    <plugin filename="gz-sim-joint-state-publisher-system" name="gz::sim::systems::JointStatePublisher">
      <frame_id>omni_bot</frame_id>
    </plugin>
  </model>
</sdf>